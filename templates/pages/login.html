{% extends "base.html" %}

{% block title %}FaceID - Login{% endblock %}

{% block page_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/pages/camera.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/pages/login.css') }}">
{% endblock %}

{% block content %}
<div id="loginScreen" class="screen active">
    <div class="camera-container">
        <div class="camera-header">
            <button class="back-btn" onclick="navigateToWelcome()">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M19 12H5M12 19l-7-7 7-7" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
            <h2>Face Authentication</h2>
        </div>
        
        <div class="video-wrapper">
            <img id="videoFeed" src="" alt="Camera Feed">
            <div class="scan-overlay">
                <div class="corner corner-tl"></div>
                <div class="corner corner-tr"></div>
                <div class="corner corner-bl"></div>
                <div class="corner corner-br"></div>
                <div class="scan-line"></div>
            </div>
            <div id="statusMessage" class="status-message">Position your face in the frame</div>
        </div>
        
        <div class="attempt-counter">
            <span id="attemptText">Attempt <span id="attemptCount">0</span> of 6</span>
        </div>
        
        <button class="btn btn-scan" onclick="attemptLogin()">
            <span class="btn-text">Scan Face</span>
            <span class="btn-glow"></span>
        </button>
    </div>
</div>

<!-- Error Modal -->
<div id="errorModal" class="modal">
    <div class="modal-content">
        <div class="modal-icon error-icon">âœ•</div>
        <h2 class="modal-title">Authentication Failed</h2>
        <p class="modal-message">We couldn't recognize your face after 6 attempts.</p>
        <button class="btn btn-primary" onclick="navigateToRegisterFromError()">
            <span class="btn-text">Don't have an account? Register here</span>
            <span class="btn-glow"></span>
        </button>
        <button class="btn btn-ghost" onclick="closeErrorModal()">
            <span class="btn-text">Try Again</span>
        </button>
    </div>
</div>
{% endblock %}

{% block page_js %}
<script src="{{ url_for('static', filename='js/pages/login.js') }}"></script>
{% endblock %}